# BMM-Release Module Configuration
# Copy to {project-root}/.bmad/bmm-release/config.yaml and customize

# Project identification
project_name: "{{project_name}}"
user_name: "{{user_name}}"
output_folder: "docs"

# Release configuration
release:
  # Versioning scheme: semver, calver, custom
  versioning: "semver"
  
  # Version format for semver
  semver_format: "MAJOR.MINOR.PATCH"
  
  # Version format for calver (e.g., YYYY.MM.DD, YY.MM.PATCH)
  calver_format: "YYYY.MM.PATCH"
  
  # Automatically create release candidate when sprint ends
  auto_create_on_sprint_end: false
  
  # Require quality gates to pass before release
  require_quality_gates: true
  
  # Require changelog/release notes
  require_changelog: true
  
  # Release branch naming
  branch_prefix: "release/"
  
  # Tag format (supports {version} placeholder)
  tag_format: "v{version}"

# Release candidate settings
candidate:
  # How long a candidate is valid before expiring
  expiry_hours: 72
  
  # Auto-include stories marked done since last release
  auto_include_done_stories: true
  
  # Minimum stories required for release
  min_stories: 1

# Deployment configuration
deployment:
  # Available environments
  environments:
    - name: "staging"
      order: 1
      auto_deploy: true
      approval_required: false
      
    - name: "production"
      order: 2
      auto_deploy: false
      approval_required: true
      approvers:
        - "tech_lead"
        - "product_owner"
  
  # Deployment strategy: rolling, blue_green, canary
  strategy: "rolling"
  
  # Health check settings
  health_check:
    enabled: true
    endpoint: "/health"
    timeout_seconds: 300
    success_threshold: 3
    failure_threshold: 2

# Rollback configuration
rollback:
  # Automatically rollback on deployment failure
  auto_rollback_on_failure: true
  
  # Keep N previous releases for rollback
  keep_releases: 5
  
  # Health check timeout before triggering rollback
  health_check_timeout: 300
  
  # Notification on rollback
  notify_on_rollback:
    - "team_lead"
    - "on_call"

# Release notes configuration
release_notes:
  # Include in release notes
  include:
    - features
    - bug_fixes
    - improvements
    - breaking_changes
    - security_updates
    - deprecations
    
  # Categorize by story type
  categorize_by_type: true
  
  # Include contributor names
  include_contributors: true
  
  # Template to use
  template: "templates/release-notes-template.md"

# Notifications
notifications:
  # Notify on release candidate created
  on_candidate_created:
    enabled: true
    channels:
      - email

  # Notify on release deployed
  on_deployed:
    enabled: true
    channels:
      - email

  # Notify on release failed
  on_failed:
    enabled: true
    channels:
      - email

# Event subscriptions (for event bus)
events:
  subscribe:
    - "metrics.quality.pass"
    - "metrics.quality.fail"
    - "story.done"
    - "sprint.ended"
    
  publish:
    - "release.candidate.created"
    - "release.approved"
    - "release.deployed"
    - "release.failed"
    - "release.rollback.initiated"
    - "release.rollback.completed"
